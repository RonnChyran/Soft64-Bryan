<Window
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ae="clr-namespace:ICSharpCode.AvalonEdit;assembly=ICSharpCode.AvalonEdit"
        xmlns:core="clr-namespace:System;assembly=mscorlib"
        xmlns:Soft64WPF="clr-namespace:Soft64WPF" x:Class="Soft64WPF.Windows.CPUDebugger"
        xmlns:c="clr-namespace:Soft64WPF.Converters"
        xmlns:om="clr-namespace:System.Collections.ObjectModel;assembly=System"
        xmlns:win="clr-namespace:System.Windows;assembly=PresentationFramework"
        Title="CPU Debugger" Height="629.3" Width="801"
        DataContext="{Binding ., Source={StaticResource machineVM}}">
    <Grid Background="White">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="32*"/>
            <ColumnDefinition Width="29*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="11*"/>
            <RowDefinition Height="33"/>
            <RowDefinition Height="272*"/>
        </Grid.RowDefinitions>
        <Menu Grid.Row="0" Grid.ColumnSpan="2" >
            <MenuItem Header="Debugger">
                <MenuItem x:Name="xaml_MenuBtnRefreshDisam" Header="Refresh Disassembly" />
            </MenuItem>
        </Menu>
        <Soft64WPF:DisassemblyView x:Name="xaml_DiassemblyView" HorizontalAlignment="Left" Width="412" Grid.Row="2"/>
        <StackPanel Orientation="Horizontal" Grid.Row="1" Grid.ColumnSpan="2">
            <Button x:Name="xaml_BtnStep" Content="Step"  Margin="10,5,0,0" Grid.Row="1" VerticalAlignment="Top" Width="76" Height="22" Click="xaml_BtnStep_Click"/>
            <Button x:Name="xaml_BtnCompare" Content="Compare ..." Margin="10,5,0,0" HorizontalAlignment="Left"  Grid.Row="1" Width="76" Height="22" VerticalAlignment="Top" Click="xaml_BtnCompare_Click" />
        </StackPanel>
        
        <!-- Registers -->
        <Grid Grid.Row="2" Grid.Column="1" Margin="10,0,190,0">
            <Grid.Resources>
                <c:Hex64Converter x:Key="hex64converter" />
                <Style TargetType="TextBox" >
                    <Setter Property="Width" Value="120" />
                    <Setter Property="Margin" Value="5,0,0,0" />
                    <Style.Triggers>
                        <Trigger Property="Validation.HasError" Value="True">
                            <Setter Property="ToolTip" Value="{Binding RelativeSource={x:Static RelativeSource.Self}, Path=(Validation.Errors)[0].ErrorContent}"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
                
                <Soft64WPF:RegisterObserverCollection x:Key="registers">
                    <Soft64WPF:RegisterObserver RegName="PC" Path="Cpu.State.RegisterPC.Value" />
                    <Soft64WPF:RegisterObserver RegName="Hi" Path="Cpu.State.RegisterHi.Value" />
                    <Soft64WPF:RegisterObserver RegName="Lo" Path="Cpu.State.RegisterLo.Value" />
                </Soft64WPF:RegisterObserverCollection>
                
                </Grid.Resources>

            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <ItemsControl ItemsSource="{StaticResource registers}" Background="#FF5DCD81" FontWeight="Bold" FontFamily="Consolas" FontSize="14">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Vertical" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <DockPanel Margin="5">
                                <TextBlock Text="{Binding Name}" HorizontalAlignment="Left"/>
                                <TextBox Text="{Binding TargetBinding, Mode=OneTime}" HorizontalAlignment="Right" />
                            </DockPanel>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </Grid>
    </Grid>
</Window>